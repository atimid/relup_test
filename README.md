relup_test
=====

An OTP application

Build
-----

    $ rebar3 compile



### Reproduce

1. checkout 1.1.0
run `rebar3 as prod tar`
2. start 1.1.0 release
```
$ mkdir temp_run
$ cd temp_run 
$ mkdir relup_test
$ cp xx/relup_test-1.1.0.tar.gz .
$ tar -zxf relup_test-1.1.0.tar.gz
$ ./bin/relup_test daemon
```
3. checkout 1.1.1 
```
$ rebar3 as prod relup --relname relup_test --relvsn 1.1.1
$ rebar3 as prod tar

```
4. upgrde application
```
$ cp xxx/relup_test-1.1.1.tar.gz ./releases
$ ./bin/relup_test unpack 1.1.1
Release 1.1.1 not found, attempting to unpack releases/relup_test-1.1.1.tar.gz
Unpacked successfully: "1.1.1"
$ ./bin/relup_test install 1.1.1
Release 1.1.1 is already unpacked, now installing.
ERROR: release_handler:check_install_release failed: {'EXIT',
                                                      {{badmatch,
                                                        {error,beam_lib,
                                                         {missing_chunk,
                                                          <<70,79,82,49,0,0,4,
                                                            24,66,69,65,77,76,
                                                            105,110,101,0,0,0,
                                                            120,0,0,0,0,0,0,0,
                                                            0,0,0,0,16,0,0,0,
                                                            12,0,0,0,1,18,9,25,
                                                            9,26,9,28,9,29,9,
                                                            32,9,35,9,38,9,39,
                                                            9,40,9,45,9,48,9,
                                                            49,0,73,47,85,115,
                                                            101,114,115,47,121,
                                                            97,110,103,103,97,
                                                            111,47,100,101,109,
                                                            111,47,116,101,109,
                                                            112,49,47,114,101,
                                                            108,117,112,95,116,
                                                            101,115,116,47,97,
                                                            112,112,115,47,114,
                                                            101,108,117,112,95,
                                                            116,101,115,116,47,
                                                            115,114,99,47,104,
                                                            101,108,108,111,95,
                                                            115,101,114,118,
                                                            101,114,46,101,114,
                                                            108,65,116,85,56,0,
                                                            0,0,205,0,0,0,21,
                                                            12,104,101,108,108,
                                                            111,95,115,101,114,
                                                            118,101,114,10,115,
                                                            116,97,114,116,95,
                                                            108,105,110,107,10,
                                                            103,101,110,95,115,
                                                            101,114,118,101,
                                                            114,4,105,110,105,
                                                            116,6,101,114,108,
                                                            97,110,103,4,115,
                                                            101,108,102,5,104,
                                                            101,108,108,111,10,
                                                            115,101,110,100,95,
                                                            97,102,116,101,114,
                                                            11,104,97,110,100,
                                                            108,101,95,99,97,
                                                            108,108,18,104,101,
                                                            108,108,111,95,115,
                                                            101,114,118,101,
                                                            114,95,115,116,97,
                                                            116,101,5,114,101,
                                                            112,108,121,2,111,
                                                            107,11,104,97,110,
                                                            100,108,101,95,99,
                                                            97,115,116,7,110,
                                                            111,114,101,112,
                                                            108,121,11,104,97,
                                                            110,100,108,101,95,
                                                            105,110,102,111,2,
                                                            105,111,6,102,111,
                                                            114,109,97,116,9,
                                                            116,101,114,109,
                                                            105,110,97,116,101,
                                                            11,99,111,100,101,
                                                            95,99,104,97,110,
                                                            103,101,11,109,111,
                                                            100,117,108,101,95,
                                                            105,110,102,111,15,
                                                            103,101,116,95,109,
                                                            111,100,117,108,
                                                            101,95,105,110,102,
                                                            111,0,0,0,67,111,
                                                            100,101,0,0,1,103,
                                                            0,0,0,16,0,0,0,0,0,
                                                            0,0,164,0,0,0,20,0,
                                                            0,0,9,1,16,153,16,
                                                            2,18,34,0,1,32,64,
                                                            2,35,64,18,19,64,2,
                                                            51,64,71,0,3,153,
                                                            32,78,64,0,1,48,
                                                            153,48,2,18,66,16,
                                                            1,64,52,53,3,12,0,
                                                            0,9,16,19,64,114,
                                                            35,64,25,39,16,3,
                                                            153,64,7,48,32,64,
                                                            71,16,3,18,0,19,1,
                                                            80,153,80,2,18,146,
                                                            48,1,96,159,85,35,
                                                            32,162,16,64,48,
                                                            164,3,23,48,178,
                                                            194,35,19,1,112,
                                                            153,96,2,18,210,32,
                                                            1,128,159,117,19,
                                                            32,162,16,48,32,
                                                            164,3,23,32,226,19,
                                                            19,1,144,153,112,2,
                                                            18,242,32,1,160,43,
                                                            181,3,114,159,149,
                                                            19,32,162,13,16,
                                                            112,32,64,19,4,66,
                                                            19,16,3,164,3,23,
                                                            64,18,9,39,71,32,3,
                                                            69,3,2,19,64,71,48,
                                                            3,153,128,7,32,48,
                                                            9,16,19,64,114,35,
                                                            64,25,39,16,3,153,
                                                            144,7,48,32,16,48,
                                                            0,164,3,23,32,226,
                                                            4,18,16,19,1,176,
                                                            159,149,19,32,162,
                                                            16,48,32,164,3,23,
                                                            32,226,19,19,1,192,
                                                            153,160,2,18,10,18,
                                                            32,1,208,159,197,
                                                            19,32,162,64,194,3,
                                                            19,1,224,153,176,2,
                                                            18,10,19,48,1,240,
                                                            159,229,19,32,162,
                                                            13,16,112,48,64,19,
                                                            4,164,3,23,64,18,9,
                                                            49,3,35,69,3,2,19,
                                                            64,71,64,3,153,192,
                                                            7,32,48,16,48,0,
                                                            164,3,23,32,194,4,
                                                            18,16,19,1,8,16,
                                                            153,0,2,18,10,20,0,
                                                            1,8,17,64,18,3,153,
                                                            0,78,16,64,1,8,18,
                                                            153,0,2,18,10,20,
                                                            16,1,8,19,64,3,19,
                                                            64,18,3,153,0,78,
                                                            32,80,3,0,83,116,
                                                            114,84,0,0,0,0,73,
                                                            109,112,84,0,0,0,
                                                            76,0,0,0,6,0,0,0,3,
                                                            0,0,0,2,0,0,0,4,0,
                                                            0,0,5,0,0,0,6,0,0,
                                                            0,0,0,0,0,5,0,0,0,
                                                            8,0,0,0,3,0,0,0,16,
                                                            0,0,0,17,0,0,0,2,0,
                                                            0,0,5,0,0,0,21,0,0,
                                                            0,1,0,0,0,5,0,0,0,
                                                            21,0,0,0,2,69,120,
                                                            112,84,0,0,0,112,0,
                                                            0,0,9,0,0,0,20,0,0,
                                                            0,1,0,0,0,19,0,0,0,
                                                            20,0,0,0,0,0,0,0,
                                                            17,0,0,0,19,0,0,0,
                                                            3,0,0,0,15,0,0,0,
                                                            18,0,0,0,2,0,0,0,
                                                            13,0,0,0,15,0,0,0,
                                                            2,0,0,0,10,0,0,0,
                                                            13,0,0,0,2,0,0,0,8,
                                                            0,0,0,9,0,0,0,3,0,
                                                            0,0,6,0,0,0,4,0,0,
                                                            0,1,0,0,0,4,0,0,0,
                                                            2,0,0,0,0,0,0,0,2,
                                                            76,105,116,84,0,0,
                                                            0,111,0,0,0,132,
                                                            120,156,99,96,96,
                                                            96,101,96,96,144,
                                                            106,206,96,74,97,
                                                            96,205,201,79,78,
                                                            204,73,97,224,201,
                                                            72,205,201,201,143,
                                                            47,78,45,42,75,45,
                                                            2,202,42,131,101,
                                                            153,242,179,65,148,
                                                            16,178,100,124,113,
                                                            73,98,73,106,54,3,
                                                            99,57,80,25,103,
                                                            115,54,3,43,88,22,
                                                            200,17,0,114,120,
                                                            60,64,28,5,43,133,
                                                            186,130,186,60,160,
                                                            152,24,80,76,200,
                                                            57,63,37,53,222,57,
                                                            35,49,47,61,21,42,
                                                            3,0,250,137,36,132,
                                                            0>>,
                                                          "Attr"}}},
                                                       [{release_handler_1,
                                                         get_vsn,1,
                                                         [{file,
                                                           "release_handler_1.erl"},
                                                          {line,779}]},
                                                        {release_handler_1,
                                                         add_vsns,3,
                                                         [{file,
                                                           "release_handler_1.erl"},
                                                          {line,735}]},
                                                        {release_handler_1,
                                                         '-eval/2-fun-0-',4,
                                                         [{file,
                                                           "release_handler_1.erl"},
                                                          {line,319}]},
                                                        {lists,foldl,3,
                                                         [{file,"lists.erl"},
                                                          {line,1263}]},
                                                        {release_handler_1,
                                                         eval,2,
                                                         [{file,
                                                           "release_handler_1.erl"},

```

